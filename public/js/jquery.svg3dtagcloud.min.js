window.SVG3DTagCloud=function(t,e){function i(){var e=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,i=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,o=e,r=i;h.width.toString().indexOf("%")>0||h.height.toString().indexOf("%")>0?(o=Math.round(t.offsetWidth/100*parseInt(h.width)),r=Math.round(o/100*parseInt(h.height))):(o=parseInt(h.width),r=parseInt(h.height)),o>=e&&(o=e),r>=i&&(r=i),y={x:o/2,y:r/2},P.x=h.speed/y.x,P.y=h.speed/y.y,1>(m=o>=r?r/100*parseInt(h.radius):o/100*parseInt(h.radius))&&(m=1),(v=m/2)<h.radiusMin&&(v=h.radiusMin,m=2*v),p.setAttribute("width",o),p.setAttribute("height",r),h.bgDraw&&(g.setAttribute("width",o),g.setAttribute("height",r)),n(v)}function n(t){for(var e=0,i=x.length;i>e;e++)o(x[e],t)}function o(t,e){var i=t.vectorPosition.x-A.x,n=t.vectorPosition.y-A.y,o=t.vectorPosition.z-A.z,r=Math.sqrt(i*i+n*n+o*o);t.vectorPosition.x/=r,t.vectorPosition.y/=r,t.vectorPosition.z/=r,t.vectorPosition.x*=e,t.vectorPosition.y*=e,t.vectorPosition.z*=e}function r(t,e,i,n,o){var r={};return r.element=document.createElementNS(z,"text"),r.element.setAttribute("x",0),r.element.setAttribute("y",0),r.element.setAttribute("fill",h.fontColor),r.element.setAttribute("font-family",h.fontFamily),r.element.setAttribute("font-size",h.fontSize),r.element.setAttribute("font-weight",h.fontWeight),r.element.setAttribute("font-style",h.fontStyle),r.element.setAttribute("font-stretch",h.fontStretch),r.element.setAttribute("text-anchor","middle"),r.element.textContent=h.fontToUpperCase?e.label.toUpperCase():e.label,r.link=document.createElementNS(z,"a"),r.link.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",e.url),r.link.setAttribute("target",e.target),r.link.addEventListener("mouseover",u,!0),r.link.addEventListener("mouseout",c,!0),r.link.appendChild(r.element),r.index=t,r.mouseOver=!1,r.vectorPosition={x:i,y:n,z:o},r.vector2D={x:0,y:0},p.appendChild(r.link),r}function s(t){for(var e=function(t){for(var e=0,i=x.length;i>e;e++){var n=x[e];if(n.element.getAttribute("x")===t.getAttribute("x")&&n.element.getAttribute("y")===t.getAttribute("y"))return n}}(t),i=0,n=x.length;n>i;i++){var o=x[i];o.index===e.index?o.mouseOver=!0:o.mouseOver=!1}}function a(){requestAnimFrame(a),function(){var t=P.x*b.x-h.speed,e=h.speed-P.y*b.y,i=t*M,n=e*M;S.sx=Math.sin(i),S.cx=Math.cos(i),S.sy=Math.sin(n),S.cy=Math.cos(n);for(var o=0,r=x.length;r>o;o++){var s=x[o];if(w){var a=s.vectorPosition.x,u=s.vectorPosition.y*S.sy+s.vectorPosition.z*S.cy;s.vectorPosition.x=a*S.cx+u*S.sx,s.vectorPosition.y=s.vectorPosition.y*S.cy+s.vectorPosition.z*-S.sy,s.vectorPosition.z=a*-S.sx+u*S.cx}var c,l=h.fov/(h.fov+s.vectorPosition.z);s.vector2D.x=s.vectorPosition.x*l+y.x,s.vector2D.y=s.vectorPosition.y*l+y.y,s.element.setAttribute("x",s.vector2D.x),s.element.setAttribute("y",s.vector2D.y),w?(c=(v-s.vectorPosition.z)/m)<h.opacityOut&&(c=h.opacityOut):(c=parseFloat(s.element.getAttribute("opacity")),c+=s.mouseOver?(h.opacityOver-c)/h.opacitySpeed:(h.opacityOut-c)/h.opacitySpeed),s.element.setAttribute("opacity",c)}x=x.sort((function(t,e){return e.vectorPosition.z-t.vectorPosition.z}))}()}function u(t){w=!1,s(t.target)}function c(t){w=!0}function l(t){b=function(t,e){var i=t.getBoundingClientRect();return{x:e.clientX-i.left,y:e.clientY-i.top}}(p,t)}function d(t){i()}var h={entries:[],width:480,height:480,radius:"70%",radiusMin:75,bgDraw:!0,bgColor:"#000",opacityOver:1,opacityOut:.05,opacitySpeed:6,fov:800,speed:2,fontFamily:"Arial, sans-serif",fontSize:"15",fontColor:"#fff",fontWeight:"normal",fontStyle:"normal",fontStretch:"normal",fontToUpperCase:!1};if(void 0!==e)for(var f in e)e.hasOwnProperty(f)&&h.hasOwnProperty(f)&&(h[f]=e[f]);if(!h.entries.length)return!1;var v,m,y,p,g,x=[],w=!0,b={x:0,y:0},A={x:0,y:0,z:0},P={x:0,y:0},S={sx:0,cx:0,sy:0,cy:0},M=Math.PI/180,z="http://www.w3.org/2000/svg";window.requestAnimFrame=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(t){window.setTimeout(t,1e3/60)},(p=document.createElementNS(z,"svg")).addEventListener("mousemove",l),t.appendChild(p),h.bgDraw&&((g=document.createElementNS(z,"rect")).setAttribute("x",0),g.setAttribute("y",0),g.setAttribute("fill",h.bgColor),p.appendChild(g)),function(){for(var t=1,e=h.entries.length+1;e>t;t++){var i=Math.acos((2*t-1)/e-1),n=Math.sqrt(e*Math.PI)*i,o=Math.cos(n)*Math.sin(i),s=Math.sin(n)*Math.sin(i),a=Math.cos(i),u=r(t-1,h.entries[t-1],o,s,a);x.push(u)}}(),i(),a(),window.addEventListener("resize",d)},"undefined"!=typeof jQuery&&function(t){t.fn.svg3DTagCloud=function(e){return this.each((function(){t.data(this,"plugin_SVG3DTagCloud")||t.data(this,"plugin_SVG3DTagCloud",new SVG3DTagCloud(this,e))}))}}(jQuery);
